---
title: "This document contains two clinical demonstrations/examples of some of the statistical work I do."
output: html_document
date: "2025-17-10"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## A. Pharmaceutical Example (Taken from a real project and modified to make it easier to understand).

If say, a pharmaceutical company is considering revising its production process for its 200 mg capsules of a
certain medication used for treating a disease. Let me call the disease COVID900. Let's also assume that a quality control manager task me to
present the data and resulting conclusions to the Board of Directors as a Statistician. Now, let's explore the process of getting accurate data and conclusion to the board of directors.

## First

I have to get some data (Skipping the scientific methodology of identification of problem, stating the aim, ...etc.). My task will be to randomly sample about 20 capsules from the current production process and 20 capsules from the potential new process. I then store the data in the csv file called meds.csv which contains the mass of these sampled capsules in milligrams.
As I analyze the data, the goal will be to check and verify all assumtion of methods and models I am using.

```{r}
#loading a few packages
library(lawstat)
library(DescTools)

meds <- read.csv("C:/Users/radje/Desktop/USB/WKU some/Statistical Methods/Statistical Methods. Everything/meds.csv")

```


## Second,

I will have to provide a numerical and graphical summaries, a thorough description of the dataset that will be suitable
for presentation to the Board of Directors.


```{r}

attach(meds)
meds
hist(New, main = "Mass of New CAPSULES", xlab ="Mass of Capsules(Milligrams)", right=F)
hist(Current, main = "Mass of Current CAPSULES", xlab ="Mass of Capsules(Milligrams)", right=F)

boxplot(meds,xlab="Type of production Process",ylab="Mass of Capsules(Milligram)")
points(1,mean(New),col='red',cex=1.5)
points(1,mean(New),col='red',cex=1.5,pch=19)
points(2,mean(Current),col='red',cex=1.5,pch=19)


IQR(New)
IQR(Current)

sd(New)
sd(Current)
mean(Current)
mean(New)

```

Notice that the interquartile range for the New production process is 6.125 The interquartile range for the Current production process is 29.7 The standard deviation of the New production process is 4.717925. The standard deviation of the Current  production process is 18.86374 The mean of the New production process is 200.525. The mean of the Current production process is 200.755



## Third,

Keeping the goal of this study in mind, I am going to use appropriate inferential tools to conduct a thorough
statistical analysis of this dataset.


```{r}
qqnorm(New, pch=19, main="New production Process", cex.axis=0.6, cex.lab=0.8)
qqnorm(Current, pch=19, main="Current Productiion Process", cex.axis=0.6, cex.lab=0.8)

```

The normal probability plots are both pretty linear, and the boxplots are pretty symmetric. I do not see any major reasons to not operate under the assumption of normality. Additionally, we are told that random samples were selected from both types of production process. I have no reason to assume these samples weren’t selected independently of one another.


```{r}
var.test(New,Current, alternative="less")
```


**Hypotheses**

1.
 \(H_0: \sigma_{\text{New}} \ge \sigma_{\text{Current}}\)  
 \(H_a: \sigma_{\text{New}} < \sigma_{\text{Current}}\)

2. The assumptions of this test is described above.
3. F= 0.062553 (see output above)
4. p-value = 0(see output above)
5. Reject H0 (assuming alpha = 0.05)



At the 0.05 significance level (p-value = 0), there is sufficient evidence to conclude that the new production process for making the 200mg capsules for treating COVID900 has less variability in terms of its mass in milligrams compared to the current one.



## Fourth and finally,

Conclusion: Based on the results above, I will recommend to the Board of Directors that the company switch to the new production Process. Although both processes means are similar, I will prefer the production process that produces a more consistent, less variable results. Thus, the new production process is better.







## B. Another clinical example taken from a real project and modified for easier comprehension.

Let assume scientists want to conduct an experiment to test the effects of five different treatment diets on some subjects, say turkeys.
My task is to statistically evaluate the amount of weight gained at the end of the alloted time period. So, to desing this experiment and make high level informed decisions, I will begin by:

## First

I will randomly assign at least six turkeys to each of five diet groups and treat/feed them for a fixed period of time. Then determine and store the amount of weight gained (in pounds) at the end of the time period. The five diets/treatment (and their designations) are then stored in a csv file called turkeys.csv. They are as follows:

- Control diet [Control]
- Control diet + level 1 of additive A [C1A]
- Control diet + level 2 of additive A [C2A]
- Control diet + level 1 of additive B [C1B]
- Control diet + level 2 of additive B [C2B]


```{r}
turkeys <- read.csv("C:/Users/radje/Desktop/USB/WKU some/Statistical Methods/Statistical Methods. Everything/turkeys.csv")
library(lawstat)
attach(turkeys)

```



## Second,
Because this lends itself to an ANOVA, I will conduct an ANOVA to determine if there is a significant difference in the mean weight gain of
turkeys/subjects for the five diets/treatment. This requires the verification of all the necessary assumptions for an Anova.

```{r}
boxplot(Gain~Group,horizontal=T,xlab="Type of Diet",ylab="Group")
levene.test(Gain, Group)

```
The boxplots show fairly similar amounts of spread in the distributions. Furthermore, since the BFL test has a p value of  0.09506, we can assume equal population variances. 

The normal probability plot of the residuals is not perfectly linear, but it is not so bad as to raise major cause for concern about the normality assumption. Since they randomly assigned the turkeys into the diet groups, we can assume independent random samples.


```{r}
matrix(Gain, nrow=6,ncol=5,dimnames = list(c(),c("Control", "C1A","C2A","C1B","C2B")))
turkey.mat<-matrix(Gain, nrow=6,ncol=5,dimnames = list(c(),c("Control", "C1A","C2A","C1B","C2B")))
turkey.df<-as.data.frame(turkey.mat)
attach(turkey.df)
turkey.df


all.turkey.df<-c(Control,C1A,C2A,C1B,C2B)
means.turkey<-c(rep(mean(Control),6), rep(mean(C1A),6), rep(mean(C2A),6), rep(mean(C1B),6), rep(mean(C2B),6))
res.turkeys<-all.turkey.df-means.turkey
qqnorm(res.turkeys, pch=19)

```


#Evaluation/Analyses
1. 

\(H_0: \mu_{c} = \mu_{CIA} = \mu_{C2A} = \mu_{C1B} = \mu_{C2B}
\)

\(H_a: \text{Not all means are equal}\)


2. For the reasons explained above, I will conduct an ANOVA here.
3. F = 81.67( see output below)
4. p-value ≈ 0 (see output below)
5. Reject H0

At the 0.05 significance level (p-value ≈ 0), there is sufficient evidence to conclude that there
is a difference in the mean amount of weight gained after the turkeys were fed with the five different diets.


```{r}
summary(aov(Gain~Group))
```



## Third

Now, I use an appropriate multiple-comparisons procedure to determine which pairs of means are
significantly different. I use Tukey because I am doing all comparison which leads to 5C2 (combination) number of tests.


```{r}
TukeyHSD(aov(all.turkey.df~Group))
```

The p-values indicate that there are significantly different pairs:

-	C1B-C1A
-	C2A-C1A
-	C2B-C1A
-	Control-C1A
-	C2B-C1B
-	Control-C1B
-	C2B-C2A
-	Control-C2A
-	Control-C2B




## Fourth, 


I will also want to determine which of the additive diets result in a significantly different mean weight gain in
comparison to the control diet. The appropriate test hes the Dunnett test.

```{r}
all.turkey<-c(Control, C1A, C2A, C1B, C2B)
Group

DunnettTest(all.turkey, as.factor(Group), control="Control")
```

The additive diets/treatments  that differ significantly in mean weight compared to the control are CA1, C1B, C2A and C2B. Since each of those corresponding intervals are entirely positive, I conclude that those additive diets produced a significantly larger mean weight gain than the control diet. Even though these are two-sided intervals (rather than one-sided).





## Fifth,

Next will be to construct identify contrasts and use the most appropriate multiple-comparison
procedure to address the following comparisons. Which comparisons yield significant results (i.e.,
show a significant difference)? 
- i. Compare the mean for the control diet to the average of the means for the additive diets.
- ii. Compare the mean gain of the additive A diets to the control diet.
- iii. Compare the mean gain of the additive B diets to the control diet.
- iv. Compare the mean gain of the additive A diets to the additive B diets.



### NB: Using R defined levels in R
Let \(a_1, a_2, a_3, a_4,\) and \(a_5\) be the constants for the Control, C1A, C2A, C1B, and C2B means of the weights of turkeys.

**a.**

\[
4\mu_{\text{Control}} + (-1)\mu_{\text{C1A}} + (-1)\mu_{\text{C2A}} + (-1)\mu_{\text{C1B}} + (-1)\mu_{\text{C2B}} = 0
\]

The coefficients are:

\[
a_1 = 4,\quad a_2 = -1,\quad a_3 = -1,\quad a_4 = -1,\quad a_5 = -1.
\]

**b.**

\[
-2\mu_{\text{Control}} + 1\mu_{\text{C1A}} + 1\mu_{\text{C2A}} + 0\mu_{\text{C1B}} + 0\mu_{\text{C2B}} = 0
\]

The coefficients are:

\[
a_1 = -2,\quad a_2 = 1,\quad a_3 = 1,\quad a_4 = 0,\quad a_5 = 0.
\]

**c.**

\[
-2\mu_{\text{Control}} + 0\mu_{\text{C1A}} + 0\mu_{\text{C2A}} + 1\mu_{\text{C1B}} + 1\mu_{\text{C2B}} = 0
\]

The coefficients are:

\[
a_1 = -2,\quad a_2 = 0,\quad a_3 = 0,\quad a_4 = 1,\quad a_5 = 1.
\]





**d.**

\[
0\mu_{\text{Control}} + 1\mu_{\text{C1A}} + 1\mu_{\text{C2A}} + (-1)\mu_{\text{C1B}} + (-1)\mu_{\text{C2B}} = 0
\]

The coefficients are:

\[
a_1 = 0,\quad a_2 = 1,\quad a_3 = 1,\quad a_4 = -1,\quad a_5 = -1.
\]

Thus,

```{r}

library(DescTools)

a.vec<-c(1/4, 1/4, 1/4, 1/4, -1)
b.vec<-c(1/2, 0, 1/2, 0, -1)
c.vec<-c(0, 1/2, 0, 1/2, -1)
d.vec<-c(1/2, -1/2, 1/2, -1/2, 0)

cont<-cbind(a.vec,b.vec,c.vec,d.vec)

ScheffeTest(aov(all.turkey~Group), which = "Group", contrasts = cont)



```

Conclusion:  Significant contrasts are indicated by highlighted p-values and output in the above output. There is significant evidence that the mean of the control diet is different from the average of the means of the additive diets in terms of weight gain.  Furthermore, the entirely positive interval suggests that the average of the means of the additive diets is significantly higher than the control. There is also significant evidence that the mean weight gain  for the additive A diets  is significantly different than the Control. Again, the entirely positive interval suggests that additive A are more effective than the Control in terms of weight gain. Similarly, there is also significant evidence that the mean weight gain  for the additive B diets   is significantly different than the Control. Again, the entirely positive interval suggests that additive B are more effective than the Control in terms of weight gain. Finally, there is also significant evidence that the mean weight gain  for the additive A diets   is significantly different than the additive B diets. Again, the entirely negative interval suggests that additive B are more effective than the additive A in terms of weight gain.




## C. Another clinical example taken from a real project and modified for easier comprehension.







